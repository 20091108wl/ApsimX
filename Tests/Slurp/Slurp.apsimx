<?xml version="1.0" encoding="utf-8"?>
<Simulations xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Name>Simulations</Name>
  <Simulation>
    <Name>Slurp</Name>
    <WeatherFile>
      <Name>WeatherFile</Name>
      <FileName>ForeverSpringNoRain.met</FileName>
    </WeatherFile>
    <Clock>
      <Name>Clock</Name>
      <StartDate>2000-01-01T00:00:00</StartDate>
      <EndDate>2000-01-31T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>Summary</Name>
    </Summary>
    <Zone>
      <Name>Field</Name>
      <Soil>
        <Name>Soil</Name>
        <Water>
          <Name>Water</Name>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </BD>
          <AirDry>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </LL15>
          <DUL>
            <double>0.55</double>
            <double>0.55</double>
            <double>0.55</double>
            <double>0.55</double>
          </DUL>
          <SAT>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SAT>
          <KS>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </KS>
          <SoilCrop>
            <Name>Slurp</Name>
            <LL>
              <double>0.3</double>
              <double>0.3</double>
              <double>0.3</double>
              <double>0.3</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <min_crit_temp>5</min_crit_temp>
          <max_crit_temp>35</max_crit_temp>
          <max_albedo>0.23</max_albedo>
          <A_to_evap_fact>0.44</A_to_evap_fact>
          <canopy_eos_coef>1.7</canopy_eos_coef>
          <sw_top_crit>0.9</sw_top_crit>
          <sumes1_max>100</sumes1_max>
          <sumes2_max>25</sumes2_max>
          <solute_flow_eff>
            <double>1</double>
          </solute_flow_eff>
          <solute_flux_eff>
            <double>1</double>
          </solute_flux_eff>
          <gravity_gradient>2E-05</gravity_gradient>
          <specific_bd>2.65</specific_bd>
          <hydrol_effective_depth>450</hydrol_effective_depth>
          <mobile_solutes>
            <string>no3</string>
            <string>urea</string>
            <string>cl</string>
            <string>br</string>
            <string>org_n</string>
            <string>org_c_pool1</string>
            <string>org_c_pool2</string>
            <string>org_c_pool3</string>
          </mobile_solutes>
          <immobile_solutes>
            <string>nh4</string>
          </immobile_solutes>
          <canopy_fact>
            <double>1</double>
            <double>1</double>
            <double>0</double>
            <double>0</double>
          </canopy_fact>
          <canopy_fact_height>
            <double>0</double>
            <double>600</double>
            <double>1800</double>
            <double>30000</double>
          </canopy_fact_height>
          <canopy_fact_default>0.5</canopy_fact_default>
          <act_evap_method>ritchie</act_evap_method>
          <irrigation_will_runoff>false</irrigation_will_runoff>
          <irrigation_layer>1</irrigation_layer>
          <obsrunoff_name />
          <SummerCona>3</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>3</WinterCona>
          <WinterU>6</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <eo_source />
          <max_pond>0</max_pond>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <WaterTable>NaN</WaterTable>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
          <wfpsN2N2O_x>
            <double>22</double>
            <double>88</double>
          </wfpsN2N2O_x>
          <wfpsN2N2O_y>
            <double>0.1</double>
            <double>1</double>
          </wfpsN2N2O_y>
          <oc>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </oc>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <RootCN>40</RootCN>
          <RootWt>0</RootWt>
          <SoilCN>12.5</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-60</string>
            <string>60-90</string>
          </Depth>
          <OC>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </OC>
          <FBiom>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Name>Analysis</Name>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <EC>
            <double>0.2</double>
            <double>0.25</double>
            <double>0.31</double>
            <double>0.4</double>
          </EC>
          <PH>
            <double>8.4</double>
            <double>8.8</double>
            <double>9</double>
            <double>9.2</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <InitialWater>
          <Name>Initial water</Name>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>1</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
          <RelativeTo>LL15</RelativeTo>
        </InitialWater>
        <Sample>
          <Name>Sample</Name>
          <Thickness>
            <double>100</double>
            <double>200</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>40</double>
            <double>30</double>
            <double>14</double>
            <double>14</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <RecordNumber>0</RecordNumber>
        <SoilType>Uniform soil</SoilType>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
          <ResidueTypes>
            <Name>ResidueTypes</Name>
            <LoadFromResource>ResidueTypes</LoadFromResource>
          </ResidueTypes>
        <_standing_fraction>
          <double>0</double>
        </_standing_fraction>
        <c_fract>0.4</c_fract>
        <report_additions>no</report_additions>
        <report_removals>no</report_removals>
        <residueTypes />
        <PoolName>Slurp</PoolName>
        <type>Slurp</type>
        <mass>0</mass>
        <standing_fraction>0</standing_fraction>
        <cnr>80</cnr>
        <crit_residue_wt>2000</crit_residue_wt>
        <opt_temp>20</opt_temp>
        <cum_eos_max>20</cum_eos_max>
        <cnrf_coeff>0.277</cnrf_coeff>
        <cnrf_optcn>25</cnrf_optcn>
        <leach_rain_tot>25</leach_rain_tot>
        <min_rain_to_leach>10</min_rain_to_leach>
        <crit_min_surfom_orgC>0.004</crit_min_surfom_orgC>
        <default_cpr>0</default_cpr>
        <standing_extinct_coeff>0.5</standing_extinct_coeff>
        <fractionFaecesAdded>0.5</fractionFaecesAdded>
      </SurfaceOrganicMatter>
      <Manager>
        <Name>SlurpUpdates</Name>
        <Script>
          <DateToUpdate>1990-01-01</DateToUpdate>
          <VariableToUpdate>[Slurp].CanopyProperties.LAI</VariableToUpdate>
          <tempValue>3.5</tempValue>
        </Script>
        <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.PMF.Slurp;
namespace Models
{
	[Serializable]
	[System.Xml.Serialization.XmlInclude(typeof(Model))]
	public class Script : Model
	{
		[Link] Clock Clock;
		[Link] Slurp Slurp;
		[Link] Report Report;
		[Link] Summary Summary;
		

		[Description("Date to change states or properties")] public DateTime DateToUpdate {get; set;}
		[Description("Variable to update (e.g. LAI, LAItot, CoverGreen")] public string VariableToUpdate {get; set;}        
        [Description("Value to update to")] public double tempValue { get; set; }

		public string myString;

		public override void OnSimulationCommencing()
		{
		}
		
		[EventSubscribe("DoManagement")]
		private void OnDoManagement(object sender, EventArgs e)
		{	
			if (Clock.Today == DateToUpdate)
			{
                myString="SlurpUpdates is resetting the value of " + VariableToUpdate + " to " + tempValue.ToString();
			    Summary.WriteMessage(FullPath, myString);
			    this.Set(VariableToUpdate, tempValue);
			}
        }
	}
}
]]></Code>
      </Manager>
      <Manager>
        <Name>Diffs</Name>
        <Script />
        <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.PMF.Slurp;
using System.Xml.Serialization;
namespace Models
{
	[Serializable]
	[System.Xml.Serialization.XmlInclude(typeof(Model))]
	public class Script : Model
	{
		[Link] Clock Clock;
		[Link] Slurp Slurp;
		[Link] Report Report;
		[Link] Summary Summary;
		[Link] Soils.Soil Soil;

		public string myString;
        private double tempSum;

        [XmlIgnore] public double initSWDep { get; set; }
        [XmlIgnore] public double currSWDep { get; set; }
        [XmlIgnore] public double diffSWDepUptake { get; set; }

        [XmlIgnore] public double initMinN { get; set; }
        [XmlIgnore] public double currMinN { get; set; }
        [XmlIgnore] public double diffMinNUptake { get; set; }

		public override void OnSimulationCommencing()
		{
		}

		[EventSubscribe("DoDailyInitialisation")]
		private void DoDailyInitialisation(object sender, EventArgs e)
		{
		    initSWDep = 0.0;
		    initMinN = 0.0;
		    for (int j = 0; j < Soil.SoilWater.dlayer.Length; j++)
		    {
		       initSWDep += Soil.SoilWater.sw_dep[j];
		       initMinN += Soil.SoilNitrogen.no3[j] + Soil.SoilNitrogen.nh4[j];
		    }
		}
		
		[EventSubscribe("DoManagementCalculations")]
		private void DoManagementCalculations(object sender, EventArgs e)
		{	
		    currSWDep = 0.0;
		    currMinN = 0.0;
		    for (int j = 0; j < Soil.SoilWater.dlayer.Length; j++)
		    {
		       currSWDep += Soil.SoilWater.sw_dep[j];
		       currMinN += Soil.SoilNitrogen.no3[j] + Soil.SoilNitrogen.nh4[j];

			   // Summary.WriteMessage(FullPath, (Soil.SoilWater.sw_dep[j].ToString() + " " + currSWDep.ToString()));
		    }
            diffSWDepUptake = (initSWDep - currSWDep) - Soil.SoilWater.es;
            diffMinNUptake = (initMinN - currMinN); // what about denitrification?
        }
	}
}
]]></Code>
      </Manager>
      <Slurp>
        <Name>Slurp</Name>
        <localLAIGreen>0</localLAIGreen>
        <localLAItot>5</localLAItot>
        <localLightExtinction>0.6</localLightExtinction>
        <localCanopyHeight>500</localCanopyHeight>
        <localCanopyDepth>500</localCanopyDepth>
        <localMaximumStomatalConductance>0.011</localMaximumStomatalConductance>
        <localFrgr>1</localFrgr>
        <localDemandWater>2</localDemandWater>
        <localDemandNitrogen>0</localDemandNitrogen>
        <localKNO3>0</localKNO3>
        <localKNH4>0</localKNH4>
        <localRootDepth>500</localRootDepth>
        <localSurfaceRootLengthDensity>0.05</localSurfaceRootLengthDensity>
      </Slurp>
      <Arbitrator>
        <Name>Arbitrator</Name>
        <ArbitrationMethod>PropDemand</ArbitrationMethod>
        <NutrientUptakeMethod>1</NutrientUptakeMethod>
      </Arbitrator>
      <Report>
        <Name>Report</Name>
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Slurp].demandWater</string>
          <string>Evaluate sum([Slurp].uptakeWater[1:4]) as UptakeWater</string>
          <string>[Slurp].potentialNitrogenDemand</string>
          <string>[Slurp].uptakeNitrogen</string>
          <string>Evaluate sum([Soil].SoilWater.sw_dep[1:4]) as SWDep</string>
          <string>[Diffs].Script.diffSWDepUptake</string>
          <string>Evaluate (sum([Soil].SoilNitrogen.nh4[1:4]) + sum([Soil].SoilNitrogen.no3[1:4]) as MinN</string>
          <string>[Diffs].Script.diffMinNUptake</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].DoReport</string>
        </EventNames>
      </Report>
      <Area>0</Area>
      <Slope>0</Slope>
    </Zone>
  </Simulation>
  <Graph>
    <Name>Graph</Name>
    <Axis>
      <Type>Bottom</Type>
      <Title />
      <Inverted>false</Inverted>
    </Axis>
    <Axis>
      <Type>Left</Type>
      <Title />
      <Inverted>false</Inverted>
    </Axis>
    <Series>
      <Title>Series1</Title>
      <Type>Line</Type>
      <XAxis>Bottom</XAxis>
      <YAxis>Left</YAxis>
      <ColourArgb>-16776961</ColourArgb>
      <Marker>None</Marker>
      <Line>Solid</Line>
      <X>
        <TableName>Report</TableName>
        <FieldName>Clock.Today</FieldName>
      </X>
      <Y>
        <TableName>Report</TableName>
        <FieldName>Slurp.demandWater</FieldName>
      </Y>
      <ShowRegressionLine>false</ShowRegressionLine>
      <ShowInLegend>true</ShowInLegend>
      <SplitOn>Simulation</SplitOn>
    </Series>
    <Series>
      <Title>Series2</Title>
      <Type>Line</Type>
      <XAxis>Bottom</XAxis>
      <YAxis>Left</YAxis>
      <ColourArgb>-32768</ColourArgb>
      <Marker>None</Marker>
      <Line>Solid</Line>
      <X>
        <TableName>Report</TableName>
        <FieldName>Clock.Today</FieldName>
      </X>
      <Y>
        <TableName>Report</TableName>
        <FieldName>UptakeWater</FieldName>
      </Y>
      <ShowRegressionLine>false</ShowRegressionLine>
      <ShowInLegend>true</ShowInLegend>
      <SplitOn>Simulation</SplitOn>
    </Series>
    <LegendPosition>TopRight</LegendPosition>
  </Graph>
  <DataStore>
    <Name>DataStore</Name>
    <AutoExport>false</AutoExport>
  </DataStore>
  <Folder>
    <Name>Folder</Name>
    <Manager>
      <Name>SlurpUpdates</Name>
      <Script>
        <DateToUpdate>2000-01-15</DateToUpdate>
        <VariableToUpdate>[Slurp].CanopyProperties.LAI</VariableToUpdate>
        <tempValue>3.5</tempValue>
      </Script>
      <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.PMF.Slurp;
namespace Models
{
	[Serializable]
	[System.Xml.Serialization.XmlInclude(typeof(Model))]
	public class Script : Model
	{
		[Link] Clock Clock;
		[Link] Slurp Slurp;
		[Link] Report Report;
		[Link] Summary Summary;
		

		[Description("Date to change states or properties")] public DateTime DateToUpdate {get; set;}
		[Description("Variable to update (e.g. LAI, LAItot, CoverGreen")] public string VariableToUpdate {get; set;}        
        [Description("Value to update to")] public double tempValue { get; set; }

        //[Description("Green LAI (m2/m2)")] public double tempLAI { get; set;}
        //[Description("Total LAI (m2/m2)")] public double tempLAItot { get; set; }
        //[Description("Green cover (m2/m2)")] public double tempCoverGreen { get; set; }
        //[Description("Total cover (m2/m2)")] public double tempCoverTot { get; set; }
        //[Description("Height of the canopy (mm)")] public double tempCanopyHeight { get; set; }
        //[Description("Depth of the canopy (mm)")] public double tempCanopyDepth { get; set; }
        //[Description("Maximum stomatal conductance (m/s)")] public double tempMaximumStomatalConductance { get; set; }
        //[Description("Frgr - effect on stomatal conductance (-)")] public double tempFrgr { get; set; }
        //[Description("Nitrogen demand (kgN /ha /day)")] public double tempPotentialNitrogenDemand { get; set; }
        //[Description("Rooting Depth (mm)")] public double tempRootDepth { get; set; }
        //[Description("Root length density at the soil surface (mm/mm3)")] public double tempSurfaceRootLengthDensity { get; set; }

		public override void OnSimulationCommencing()
		{
		    
		}
		
		[EventSubscribe("DoManagement")]
		private void OnDoManagement(object sender, EventArgs e)
		{	
			if (Clock.Today == DateToUpdate)
			{
			    this.Set(VariableToUpdate, tempValue);
			}
        }
	}
}
]]></Code>
    </Manager>
    <Slurp>
      <Name>Slurp</Name>
      <localLAIGreen>0</localLAIGreen>
      <localLAItot>5</localLAItot>
      <localLightExtinction>0</localLightExtinction>
      <localCanopyHeight>500</localCanopyHeight>
      <localCanopyDepth>500</localCanopyDepth>
      <localMaximumStomatalConductance>0.011</localMaximumStomatalConductance>
      <localFrgr>1</localFrgr>
      <localDemandWater>0</localDemandWater>
      <localDemandNitrogen>0</localDemandNitrogen>
      <localKNO3>0</localKNO3>
      <localKNH4>0</localKNH4>
      <localRootDepth>600</localRootDepth>
      <localSurfaceRootLengthDensity>0.05</localSurfaceRootLengthDensity>
    </Slurp>
    <Memo>
      <Name>Memo</Name>
      <MemoText><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
 <head>
  <title></title>
 </head>
 <body>
  <p>[Clock].Today</p>
  <p>[SlurpUpdates].DateToUpdate</p>
  <p>[SlurpUpdates].tempValue</p>
  <p>[Slurp].localLAI</p>
  <p>[Slurp].CanopyProperties</p>
  <p>[Slurp].PotentialEP</p>
  <p>[Slurp].ActualEP</p>
  <p>[Slurp].potentialNitrogenDemand</p>
  <p>[Slurp].actualNitrogenSupply</p>
  <p>[Slurp].localRootDepth</p>
  <p>[Arbitrator].scalerLayer</p>
  <p>[Arbitrator].scalerPlant</p>
  <p>[Soil].SoilWater.drain</p>
  <p>[Soil].SoilWater.es</p>
  <p>[Arbitrator].dltSWdep</p>
  <p>[Soil].SoilWater.sw_dep</p>
  <p>Evaluate (sum(([Soil].SoilWater.sw_dep[0:3] - (SoilWater.es)))) as TotalSW1</p>
  <p></p>
 </body>
</html>]]></MemoText>
    </Memo>
  </Folder>
  <ExplorerWidth>250</ExplorerWidth>
</Simulations>